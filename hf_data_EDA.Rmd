---
title: "DMML_test"
author: "Peter"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
merged_df <- fread("merged_df.csv")
merged_df$survival_time = as.numeric(difftime(merged_df$deathtime, merged_df$admittime, units = "day"))
#hello
```


```{r}
ggplot(data = data_hf, aes(`Respiratory rate`, `Urine output`, color = factor(outcome))) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)
```

```{r}
ggplot(data = data_hf, aes(x = `Urine output`, y = outcome, color = outcome)) +
  geom_jitter(width = 0.2, height = 0.05) +
  labs(title = "Scatter Plot of Urine Output vs. Outcome",
       x = "Urine Output",
       y = "Outcome") +
  theme_minimal()
```

```{r}
sum(is.na(data_hf$outcome))
```

```{r}
# Histograms for continuous variables
continuous_vars <- c('heart rate', 'Systolic blood pressure', 'Diastolic blood pressure', 'Respiratory rate', 'temperature', 'SP O2')

merged_df %>%
  select(all_of(continuous_vars)) %>%
  gather(key = "variable", value = "value") %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 15, fill = "orange", color = "black") +
  facet_wrap(~variable, scales = "free") +
  theme_minimal() +
  labs(title = "Distribution of Continuous Variables", x = "Value", y = "Frequency")

```





#t test  


```{r}
cont <- c("age", "BMI", "heart rate", "Systolic blood pressure", "Diastolic blood pressure", "Respiratory rate", "temperature", "SP O2", "Urine output", "hematocrit", "RBC", "MCH", "MCHC", "MCV", "RDW", "Leucocyte", "Platelets", "Neutrophils", "Basophils", "Lymphocyte", "PT", "INR", "NT proBNP", "Creatine kinase", "Creatinine", "Urea nitrogen", "glucose", "Blood potassium", "Blood sodium", "Blood calcium", "Chloride", "Anion gap", "Magnesium ion", "PH", "Bicarbonate", "Lactic acid", "PCO2")

for (var in cont) {
  t_test <- t.test(merged_df[[var]] ~ merged_df$outcome, data = merged_df)
  print(paste("T-test for", var))
  print(t_test)
}
```


# chi-square test 

```{r}
cat <- c("gendera", "hypertensive", "atrialfibrillation", "CHD with no MI", "diabetes", "deficiencyanemias", "depression", "Hyperlipemia", "Renal failure", "COPD")

for (var in cat) {
  chi_sq <- chisq.test(table(merged_df[[var]], merged_df$outcome))
  print(paste("Chi-square test for", var))
  print(chi_sq)
}
```



```{r}
mod1 <- glm(outcome ~ (gendera + hypertensive + atrialfibrillation + `CHD with no MI` + diabetes + deficiencyanemias + depression + Hyperlipemia + `Renal failure` + COPD), data = merged_df)
mod1
summary(mod1)
```


